{% extends "admin/base.html" %}

{% block title %}Today's Attendance{% endblock %}

{% block content %}
<div class="section active">
  <div class="card">
    <div class="card-title" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Today's Attendance</span>
      {% if records %}
      <div style="display: flex; gap: 8px;">
        <a href="{{ url_for('admin.export_attendance', format='csv') }}?date={{ selected_date }}" 
           class="btn-export" 
           style="padding: 8px 16px; background: #10b981; color: white; text-decoration: none; border-radius: 6px; font-size: 13px; display: inline-flex; align-items: center; gap: 5px;">
          üìÑ CSV
        </a>
        <a href="{{ url_for('admin.export_attendance', format='excel') }}?date={{ selected_date }}" 
           class="btn-export" 
           style="padding: 8px 16px; background: #059669; color: white; text-decoration: none; border-radius: 6px; font-size: 13px; display: inline-flex; align-items: center; gap: 5px;">
          üìä Excel
        </a>
        <a href="{{ url_for('admin.export_attendance', format='pdf') }}?date={{ selected_date }}" 
           class="btn-export" 
           style="padding: 8px 16px; background: #dc2626; color: white; text-decoration: none; border-radius: 6px; font-size: 13px; display: inline-flex; align-items: center; gap: 5px;">
          üìë PDF
        </a>
      </div>
      {% endif %}
    </div>
    
    <!-- Date Selector -->
    <div style="margin-bottom: 20px;">
      <form method="GET" action="{{ url_for('admin.attendance') }}" style="display: flex; gap: 10px; align-items: center;">
        <label style="font-weight: 500;">Select Date:</label>
        <input type="date" name="date" value="{{ selected_date }}" style="width: auto;">
        <button type="submit">View</button>
      </form>
    </div>

    <!-- Attendance Table -->
    {% if records %}
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Date</th>
          <th>Time In</th>
          <th>Lunch Out</th>
          <th>Afternoon In</th>
          <th>Time Out</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for record in records %}
        <tr>
          <td>{{ record.full_name }}</td>
          <td>{{ record.date }}</td>
          <td>{{ record.morning_in or '--' }}</td>
          <td>{{ record.lunch_out or '--' }}</td>
          <td>{{ record.afternoon_in or '--' }}</td>
          <td>{{ record.time_out or '--' }}</td>
          <td>
            {% if record.attendance_status == 'Present' %}
              <span class="badge present">Present</span>
            {% elif record.attendance_status == 'Late' %}
              <span style="color: #f59e0b; font-weight: 500;">Late</span>
            {% elif record.attendance_status == 'Absent' %}
              <span style="color: #ef4444; font-weight: 500;">Absent</span>
            {% else %}
              <span style="color: #6b7280;">--</span>
            {% endif %}
          </td>
          <td>
            <a href="{{ url_for('admin.edit_dtr', attendance_id=record.attendance_id) }}" 
               class="btn-edit" 
               style="padding: 6px 12px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; font-size: 13px; display: inline-block;">
              ‚úèÔ∏è Edit
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p style="margin-top: 20px; color: #6b7280; text-align: center; padding: 40px;">
      No attendance records for {{ selected_date }}
    </p>
    {% endif %}
  </div>
</div>
{% endblock %}
